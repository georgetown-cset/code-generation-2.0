ESBMC version 7.4.0 64-bit x86_64 linux
Target: 64-bit little-endian x86_64-unknown-linux with esbmclibc
Target: 64-bit little-endian x86_64-unknown-linux with esbmclibc
Target: 64-bit little-endian x86_64-unknown-linux with esbmclibc
Parsing /home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c
Parsing /home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c
/home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c:5:20: warning: implicitly declaring library function 'malloc' with type 'void *(unsigned long)' [-Wimplicit-function-declaration]
    char *buffer = malloc(buffer_size);
                   ^
/home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c:5:20: note: include the header <stdlib.h> or explicitly provide a declaration for 'malloc'
/home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c:8:9: warning: implicit declaration of function 'free' is invalid in C99 [-Wimplicit-function-declaration]
        free(buffer);
        ^
Converting
/home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c:5:20: warning: implicitly declaring library function 'malloc' with type 'void *(unsigned long)' [-Wimplicit-function-declaration]
    char *buffer = malloc(buffer_size);
                   ^
/home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c:5:20: note: include the header <stdlib.h> or explicitly provide a declaration for 'malloc'
/home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c:8:9: warning: implicit declaration of function 'free' is invalid in C99 [-Wimplicit-function-declaration]
        free(buffer);
        ^
Converting
Parsing /home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c
/home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c:5:20: warning: implicitly declaring library function 'malloc' with type 'void *(unsigned long)' [-Wimplicit-function-declaration]
    char *buffer = malloc(buffer_size);
                   ^
/home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c:5:20: note: include the header <stdlib.h> or explicitly provide a declaration for 'malloc'
/home/mw1442/code-generation-2.0/generated_llama/CWE-416_UAF-1c.c:8:9: warning: implicit declaration of function 'free' is invalid in C99 [-Wimplicit-function-declaration]
        free(buffer);
        ^
Converting
Generating GOTO Program
GOTO program creation time: 0.165s
GOTO program processing time: 0.000s
Checking base case, k = 1

Starting Bounded Model Checking
Not unwinding loop 2 iteration 1   file CWE-416_UAF-1c.c line 6 column 5 function main
Symex completed in: 0.001s (22 assignments)
Slicing time: 0.000s (removed 14 assignments)
Generated 4 VCC(s), 3 remaining after simplification (8 assignments)
No solver specified; defaulting to Boolector
Slicing for Claim arithmetic overflow on add (0.000s)
Slicing time: 0.000s (removed 14 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.001s
Solving claim 'arithmetic overflow on add' with solver Boolector 3.2.2
Slicing for Claim dereference failure: invalidated dynamic object (0.000s)
Slicing time: 0.000s (removed 14 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.000s
Solving claim 'dereference failure: invalidated dynamic object' with solver Boolector 3.2.2
Slicing for Claim dereference failure: invalidated dynamic object freed (0.000s)
Slicing time: 0.000s (removed 14 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.000s
Solving claim 'dereference failure: invalidated dynamic object freed' with solver Boolector 3.2.2
BMC program time: 0.014s
Checking base case, k = 2

Starting Bounded Model Checking
Unwinding loop 2 iteration 1   file CWE-416_UAF-1c.c line 6 column 5 function main
Not unwinding loop 2 iteration 2   file CWE-416_UAF-1c.c line 6 column 5 function main
Symex completed in: 0.001s (27 assignments)
Slicing time: 0.000s (removed 15 assignments)
Generated 8 VCC(s), 6 remaining after simplification (12 assignments)
No solver specified; defaulting to Boolector
Slicing for Claim arithmetic overflow on add (0.000s)
Slicing time: 0.000s (removed 15 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.001s
Solving claim 'arithmetic overflow on add' with solver Boolector 3.2.2
Slicing for Claim dereference failure: invalidated dynamic object (0.000s)
Slicing time: 0.000s (removed 15 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.001s
Solving claim 'dereference failure: invalidated dynamic object' with solver Boolector 3.2.2
Generating GOTO Program
GOTO program creation time: 0.222s
GOTO program processing time: 0.000s
Checking forward condition, k = 2
Starting Bounded Model Checking
Unwinding loop 2 iteration 1   file CWE-416_UAF-1c.c line 6 column 5 function main
Not unwinding loop 2 iteration 2   file CWE-416_UAF-1c.c line 6 column 5 function main
Symex completed in: 0.001s (27 assignments)
Slicing time: 0.000s (removed 15 assignments)
Generated 9 VCC(s), 7 remaining after simplification (12 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.001s
Solving with solver Boolector 3.2.2

[Counterexample]


State 1 file CWE-416_UAF-1c.c line 5 column 5 function main thread 0
----------------------------------------------------
  buffer = &dynamic_3_array[0]

State 2 file CWE-416_UAF-1c.c line 8 column 9 function main thread 0
----------------------------------------------------
Violated property:
  file CWE-416_UAF-1c.c line 8 column 9 function main
  dereference failure: invalidated dynamic object

Slicing for Claim dereference failure: invalidated dynamic object freed (0.000s)
Slicing time: 0.000s (removed 15 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.000s
Solving claim 'dereference failure: invalidated dynamic object freed' with solver Boolector 3.2.2
Runtime decision procedure: 0.033s
Checking forward condition, k = 3
Starting Bounded Model Checking
Unwinding loop 2 iteration 1   file CWE-416_UAF-1c.c line 6 column 5 function main
Unwinding loop 2 iteration 2   file CWE-416_UAF-1c.c line 6 column 5 function main
Not unwinding loop 2 iteration 3   file CWE-416_UAF-1c.c line 6 column 5 function main
Symex completed in: 0.001s (32 assignments)
Slicing time: 0.000s (removed 16 assignments)
Generated 13 VCC(s), 10 remaining after simplification (16 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.001s
Solving with solver Boolector 3.2.2
Runtime decision procedure: 0.032s
Checking forward condition, k = 4
Starting Bounded Model Checking
Unwinding loop 2 iteration 1   file CWE-416_UAF-1c.c line 6 column 5 function main
Unwinding loop 2 iteration 2   file CWE-416_UAF-1c.c line 6 column 5 function main
Unwinding loop 2 iteration 3   file CWE-416_UAF-1c.c line 6 column 5 function main
Not unwinding loop 2 iteration 4   file CWE-416_UAF-1c.c line 6 column 5 function main
Symex completed in: 0.001s (37 assignments)
Slicing time: 0.000s (removed 17 assignments)
Generated 17 VCC(s), 13 remaining after simplification (20 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.001s
Solving with solver Boolector 3.2.2
Generating GOTO Program
GOTO program creation time: 0.317s
GOTO program processing time: 0.000s
Checking inductive step, k = 2
Starting Bounded Model Checking
Unwinding loop 2 iteration 1   file CWE-416_UAF-1c.c line 6 column 5 function main
Not unwinding loop 2 iteration 2   file CWE-416_UAF-1c.c line 6 column 5 function main
[Counterexample]

Symex completed in: 0.003s (37 assignments)
Slicing time: 0.000s (removed 17 assignments)
Generated 5 VCC(s), 4 remaining after simplification (20 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.001s
Solving with solver Boolector 3.2.2


State 1 file CWE-416_UAF-1c.c line 5 column 5 function main thread 0
----------------------------------------------------
  buffer = &dynamic_3_array[0]

State 2 file CWE-416_UAF-1c.c line 8 column 9 function main thread 0
----------------------------------------------------
Violated property:
  file CWE-416_UAF-1c.c line 8 column 9 function main
  dereference failure: invalidated dynamic object freed

Slicing for Claim arithmetic overflow on add (0.000s)
Slicing time: 0.000s (removed 15 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.000s
Solving claim 'arithmetic overflow on add' with solver Boolector 3.2.2
Slicing for Claim dereference failure: invalidated dynamic object (0.000s)
Slicing time: 0.000s (removed 15 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.001s
Solving claim 'dereference failure: invalidated dynamic object' with solver Boolector 3.2.2
Slicing for Claim dereference failure: invalidated dynamic object freed (0.000s)
Slicing time: 0.000s (removed 15 assignments)
No solver specified; defaulting to Boolector
Encoding remaining VCC(s) using bit-vector/floating-point arithmetic
Encoding to solver time: 0.000s
Solving claim 'dereference failure: invalidated dynamic object freed' with solver Boolector 3.2.2

Bug found by the base case (k = 2)
VERIFICATION FAILED
